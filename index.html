<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>ä»£æ›¿èŠ±ç”³è«‹ãƒ•ã‚©ãƒ¼ãƒ </title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>
<script>
  (function() {
    // ğŸ”¹ ã‚ãªãŸã®EmailJSå…¬é–‹ã‚­ãƒ¼
    emailjs.init("gjzoajs");
  })();
</script>
<style>
body {
  font-family: "Noto Sans JP", sans-serif;
  background: #f9f9f9;
  padding: 20px;
}
form {
  background: white;
  padding: 20px;
  border-radius: 10px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.1);
  max-width: 500px;
  margin: 0 auto;
}
label { display: block; margin-top: 10px; font-weight: bold; }
input, textarea, button {
  width: 100%;
  padding: 8px;
  margin-top: 4px;
  font-size: 14px;
}
textarea { resize: vertical; min-height: 80px; }
button {
  background: #2196F3; color: white; border: none; border-radius: 6px;
  margin-top: 20px; padding: 10px; font-weight: bold;
}
button:hover { background: #1976D2; }
.file-group {
  margin-top: 10px; border: 1px dashed #ccc; border-radius: 8px;
  padding: 10px; text-align: center; background: #fafafa;
}
.file-name { font-size: 13px; color: #333; margin-top: 5px; }
.hidden { display: none; }
#msg { text-align: center; margin-top: 15px; font-weight: bold; }
</style>
</head>
<body>
  <h2>ä»£æ›¿èŠ±ç”³è«‹ãƒ•ã‚©ãƒ¼ãƒ </h2>
  <form id="form">
    <label>ç”³è«‹è€…å</label>
    <input type="text" id="name" required>

    <label>å—æ³¨ç•ªå·</label>
    <input type="text" id="orderNo" required>

    <label>å–å¼•å…ˆå</label>
    <input type="text" id="vendor" required>

    <label>ä¸è‰¯ã®çŠ¶æ³</label>
    <textarea id="defectDetail" required></textarea>

    <label>ç”³ã—é€ã‚Šäº‹é …</label>
    <textarea id="note"></textarea>

    <label>ç”»åƒæ·»ä»˜ï¼ˆæœ€å¤§5æšï¼‰</label>
    <div id="fileContainer">
      <div class="file-group" id="fileGroup1">
        <input type="file" id="file1" accept="image/*">
        <div class="file-name" id="fileName1">æœªé¸æŠ</div>
      </div>
      <div class="file-group hidden" id="fileGroup2">
        <input type="file" id="file2" accept="image/*">
        <div class="file-name" id="fileName2">æœªé¸æŠ</div>
      </div>
      <div class="file-group hidden" id="fileGroup3">
        <input type="file" id="file3" accept="image/*">
        <div class="file-name" id="fileName3">æœªé¸æŠ</div>
      </div>
      <div class="file-group hidden" id="fileGroup4">
        <input type="file" id="file4" accept="image/*">
        <div class="file-name" id="fileName4">æœªé¸æŠ</div>
      </div>
      <div class="file-group hidden" id="fileGroup5">
        <input type="file" id="file5" accept="image/*">
        <div class="file-name" id="fileName5">æœªé¸æŠ</div>
      </div>
    </div>

    <button type="submit">é€ä¿¡</button>
    <p id="msg"></p>
  </form>

<script>
document.addEventListener("DOMContentLoaded", () => {
  // ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠã®é€£å‹•è¡¨ç¤º
  for (let i = 1; i <= 5; i++) {
    const input = document.getElementById(`file${i}`);
    const label = document.getElementById(`fileName${i}`);
    const next = document.getElementById(`fileGroup${i + 1}`);
    input.addEventListener('change', () => {
      if (input.files.length > 0) {
        label.textContent = input.files[0].name;
        if (next) next.classList.remove('hidden');
      } else {
        label.textContent = 'æœªé¸æŠ';
        for (let j = i + 1; j <= 5; j++) {
          document.getElementById(`fileGroup${j}`).classList.add('hidden');
          document.getElementById(`fileName${j}`).textContent = 'æœªé¸æŠ';
          document.getElementById(`file${j}`).value = '';
        }
      }
    });
  }

  document.getElementById("form").addEventListener("submit", async (e) => {
    e.preventDefault();
    const msg = document.getElementById("msg");
    msg.textContent = "é€ä¿¡ä¸­...";

    const formData = {
      name: document.getElementById("name").value,
      orderNo: document.getElementById("orderNo").value,
      vendor: document.getElementById("vendor").value,
      defectDetail: document.getElementById("defectDetail").value,
      note: document.getElementById("note").value
    };

    const attachments = [];
    for (let i = 1; i <= 5; i++) {
      const f = document.getElementById(`file${i}`).files[0];
      if (f) attachments.push(f);
    }

    try {
      await emailjs.send("service_rnifgpa", "template_gjzoajs", formData, {
        publicKey: "gjzoajs",
        attachments: attachments
      });
      msg.textContent = "é€ä¿¡ãŒå®Œäº†ã—ã¾ã—ãŸï¼";
      e.target.reset();
      // ãƒ•ã‚¡ã‚¤ãƒ«æ¬„ãƒªã‚»ãƒƒãƒˆ
      for (let i = 2; i <= 5; i++) {
        document.getElementById(`fileGroup${i}`).classList.add('hidden');
        document.getElementById(`fileName${i}`).textContent = 'æœªé¸æŠ';
      }
    } catch (error) {
      console.error(error);
      msg.textContent = "é€ä¿¡ã«å¤±æ•—ã—ã¾ã—ãŸã€‚";
    }
  });
});
</script>
</body>
</html>
